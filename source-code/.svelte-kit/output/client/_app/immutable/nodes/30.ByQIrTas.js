import"../chunks/BDr9Qe-U.js";import"../chunks/69_IOA4Y.js";import{p as ce,l as le,g as e,m as u,F as me,e as we,c as s,r,a as ue,b as l,u as $t,t as H,s as _,d as V,n as Ct,f as Et,aT as Oe}from"../chunks/UMRfY9Ko.js";import{t as A,a as L}from"../chunks/D7kVQxiR.js";import{i as Y,a as ve,s as Ge}from"../chunks/C8EeH_y7.js";import{s as F}from"../chunks/CBgq6MFg.js";import{s as J,t as Ae}from"../chunks/CC0ELNUk.js";import{b as B}from"../chunks/BqU0DZvs.js";import{i as de}from"../chunks/DwRdgw7B.js";import{p as b}from"../chunks/CSfE_DI5.js";import{c as be,o as he,a as We}from"../chunks/D_1OQ_gr.js";import{u as Ke}from"../chunks/rUUE80t4.js";import{g as Dt}from"../chunks/BhqQrrNl.js";import{s as pe}from"../chunks/Bq4tIOc4.js";import{p as Ut,s as jt,a as At,b as Lt,c as zt,v as Rt}from"../chunks/CUEp9C6H.js";import{A as He}from"../chunks/C1d6j-5H.js";import{e as Mt}from"../chunks/D7M_RLsn.js";import{z as Ve,h as Pt}from"../chunks/CpOe2gu7.js";import{C as qt}from"../chunks/CEvo3YrK.js";import{t as Ft}from"../chunks/KgIHh09F.js";import{e as Qt,f as Nt,u as Le,b as Bt,c as Ot,R as Gt,__tla as Wt}from"../chunks/BtY6RuN-.js";import{A as Kt}from"../chunks/CFS9S8Yy.js";import{g as Ht}from"../chunks/Bhxzz1gg.js";import{g as Vt}from"../chunks/CS3uJLGD.js";import{g as Xt}from"../chunks/B_ot-s7H.js";let Xe,Yt=Promise.all([(()=>{try{return Wt}catch{}})()]).then(async()=>{const Ye=""+new URL("../assets/start_challenge.B-lbAoXm.mp3",import.meta.url).href,Je=""+new URL("../assets/drumroll.DMT6Sqnq.mp3",import.meta.url).href,Ze=""+new URL("../assets/countdown.Cbs6QFWp.mp3",import.meta.url).href;var et=A("<span> </span>"),tt=A('<div class="timer svelte-kua9rn"><!></div>');function at(Q,n){ce(n,!1);let y=b(n,"start",8,!1),U=b(n,"callback",8),m=u(3),f,S=u(!1),h=u(!1);const g=be();function v(){l(S,!0),l(m,3),l(h,!0),g("mount"),f=setInterval(()=>{$t(m,-1),l(h,!1),setTimeout(()=>{l(h,!0)},10),e(m)===0&&(clearInterval(f),l(S,!1),U()&&U()())},1e3)}he(()=>()=>{f&&clearInterval(f)}),le(()=>(me(y()),e(S)),()=>{y()&&!e(S)&&v()}),we(),de();var d=tt(),C=s(d);{var D=I=>{var p=et(),k=s(p,!0);r(p),H(()=>{J(p,`count ${(e(h)?"animated":"")??""} svelte-kua9rn`),pe(k,e(m))}),L(I,p)};Y(C,I=>{y()&&e(m)>0&&I(D)})}r(d),L(Q,d),ue()}var st=A('<div class="flex-1 h-1/2 w-full bg-transparent animated-right svelte-1w4i1xc" style="border: 12px solid black; background: radial-gradient(at top, #FF981E 0%, #CB1E47 60%);"></div>'),rt=A('<div class="flex items-center gap-4 svelte-1w4i1xc"><div class="text-white font-bold text-xl svelte-1w4i1xc">Loading...</div> <div class="text-white text-[60px] font-bold pb-[0.5rem] svelte-1w4i1xc"> <span class="text-white font-bold text-xl svelte-1w4i1xc">%</span></div></div>'),it=A('<div class="mode-text flex gap-2 items-center svelte-1w4i1xc"><span class="text-white font-bold text-xl svelte-1w4i1xc">Challenge Mode in</span> <!></div>'),lt=A('<div class="h-32 w-full flex justify-center items-center svelte-1w4i1xc"><img alt="VS" class="w-[165px] h-[165px] z-[120] svelte-1w4i1xc"></div>'),ot=A('<div class="flex flex-col items-center svelte-1w4i1xc"><div class="h-[120px] w-[120px] rounded-full overflow-hidden bg-[#e5e5e5] relative p-2 svelte-1w4i1xc"><!></div> <div class="text-center mt-2 font-bold text-white text-lg svelte-1w4i1xc"> </div></div>'),nt=A('<div class="flex flex-col h-full w-full justify-center items-center text-red-500 absolute z-10 transition-width duration-300 svelte-1w4i1xc"><audio preload="auto" class="svelte-1w4i1xc"><source type="audio/mp3" class="svelte-1w4i1xc"></audio> <audio preload="auto" class="svelte-1w4i1xc"><source type="audio/mp3" class="svelte-1w4i1xc"></audio> <audio preload="auto" class="svelte-1w4i1xc"><source type="audio/mp3" class="svelte-1w4i1xc"></audio> <div class="h-full w-full fixed top-0 bg-black svelte-1w4i1xc"><div><div style="background: radial-gradient(at bottom, #00F0FF 0%, #1C62CB 60%);"></div> <!></div> <div class="max-h-screen max-w-full overflow-hidden h-full w-full fixed left-0 top-0 bottom-0 right-0 svelte-1w4i1xc"><div class="svelte-1w4i1xc"><div class="absolute left-0 right-0 top-0 bottom-0 bg-cover bg-center svelte-1w4i1xc"></div> <div class="absolute left-0 right-0 top-0 bottom-0 bg-cover bg-center transition-transform duration-0 svelte-1w4i1xc"></div></div></div> <div class="justify-center items-center flex-col h-full m-0 flex absolute top-0 bottom-0 right-0 left-0 overflow-hidden h-full max-h-full svelte-1w4i1xc"><div class="justify-center items-center flex-col h-full m-0 flex w-full max-w-5xl justify-between svelte-1w4i1xc"><div class="relative w-full flex justify-center mt-10 svelte-1w4i1xc"><div class="relative bg-contain bg-center bg-no-repeat h-[85px] w-[430px] svelte-1w4i1xc"><div class="absolute left-[110px] -ml-20 top-1/2 -translate-y-1/2 z-10 svelte-1w4i1xc"><img alt="Sword 1" class="absolute h-[70px] w-[70px] transform -rotate-8 z-20 svelte-1w4i1xc"> <img alt="Sword 2" class="relative h-[70px] w-[70px] transform rotate-8 z-20 top-0 svelte-1w4i1xc"></div> <div class="absolute w-full h-full flex items-center justify-center svelte-1w4i1xc"><!></div></div></div> <div class="mt-6 mb-6 w-full max-w-4xl svelte-1w4i1xc"><div><div class="flex flex-col items-center svelte-1w4i1xc"><div class="h-[120px] w-[120px] rounded-full overflow-hidden bg-[#e5e5e5] relative p-2 svelte-1w4i1xc"><!></div> <div class="text-center mt-2 font-bold text-white text-lg svelte-1w4i1xc"> </div></div> <div class="flex flex-col items-center justify-center svelte-1w4i1xc"><!></div> <!></div></div></div></div></div></div>');function ct(Q,n){var Qe,Ne;ce(n,!1);const[y,U]=Ge(),m=()=>ve(Ke,"$userStore",y);let f=b(n,"percent",8,0),S=b(n,"callback",8),h=b(n,"userData",8),g=b(n,"gameData",8),v=b(n,"isHundredReached",12,!1),d=u(1),C=u(!1),D=!1,I=!1,p=u(),k=u(),w=u(),R=u(),E=u(),q=u(),c=u(),Z=u();const M={username:(Qe=h())==null?void 0:Qe.name},T=((Ne=g())==null?void 0:Ne.isSinglePlayer)===0;function O(a){return a?a.length>12?a.substring(0,10)+"...":a:""}function X(a){a==="track3"?(e(p)&&e(p).pause(),e(k)&&e(k).pause(),e(w)&&e(w).play()):(a==="track1"&&e(p)&&e(p).play(),a==="track2"&&e(k)&&e(k).play())}function G(a){a==="track1"&&e(p)&&e(p).pause(),a==="track2"&&e(k)&&e(k).pause(),a==="track3"&&e(w)&&e(w).pause()}function ye(){return 1+(Math.random()*9+1)/10}function ee(a,x,z,ie,je){a&&setTimeout(()=>{a.classList.add(x),setTimeout(()=>{a.classList.remove(x)},z)},je)}he(()=>{const a=setInterval(()=>{l(d,ye())},400);return e(R)&&ee(e(R),"animate-slideInLeft",350,!1,500),e(q)&&(ee(e(q),"animate-slideInRight",350,!1,500),ee(e(E),"animate-fadeIn",750,!1,950),ee(e(E),"animate-jello",750,!1,1200)),!T&&!D&&setTimeout(()=>{X("track1"),D=!0},0),I||setTimeout(()=>{X("track2"),I=!0},2500),()=>{G("track1"),G("track2"),G("track3"),clearInterval(a)}});function ke(){S()("timeToStart")}function _e(){X("track3"),l(C,!0)}We(()=>{G("track1"),G("track2"),G("track3")}),le(()=>(me(f()),me(v())),()=>{f()>=100&&!v()&&(v(!0),setTimeout(()=>{X("track3"),l(C,!0)},500))}),we(),de();var te=nt(),W=s(te),fe=s(W);F(fe,"src",Ye),r(W),B(W,a=>l(p,a),()=>e(p));var ae=_(W,2),Ie=s(ae);F(Ie,"src",Je),r(ae),B(ae,a=>l(k,a),()=>e(k));var K=_(ae,2),oe=s(K);F(oe,"src",Ze),r(K),B(K,a=>l(w,a),()=>e(w));var xe=_(K,2),se=s(xe);J(se,`${`justify-center items-center flex-col h-full m-0 flex ${T?"twisted-ui-s":"twisted-ui"}`??""} svelte-1w4i1xc`);var t=s(se);J(t,`${`flex-1 ${T?"h-full":"h-1/2"} w-full bg-transparent ${T?"":"animated-left"}`??""} svelte-1w4i1xc`);var i=_(t,2);{var o=a=>{var x=st();L(a,x)};Y(i,a=>{T||a(o)})}r(se);var $=_(se,2),j=s($),P=s(j);F(P,"style",`background-image: url("${Ut}")`);var re=_(P,2);r(j),r($);var ze=_($,2),Re=s(ze),Se=s(Re),Te=s(Se);F(Te,"style",`background-image: url("${jt}")`);var $e=s(Te),Ce=s($e);F(Ce,"src",At),B(Ce,a=>l(c,a),()=>e(c));var Me=_(Ce,2);F(Me,"src",Lt),B(Me,a=>l(Z,a),()=>e(Z)),r($e);var Pe=_($e,2),gt=s(Pe);{var wt=a=>{var x=rt(),z=_(s(x),2),ie=s(z,!0);Ct(),r(z),r(x),H(()=>pe(ie,f())),L(a,x)},bt=a=>{var x=it(),z=_(s(x),2);at(z,{start:!0,callback:ke,$$events:{mount:_e}}),r(x),L(a,x)};Y(gt,a=>{f()>=0&&!v()?a(wt):a(bt,!1)})}r(Pe),r(Te),r(Se);var qe=_(Se,2),Ee=s(qe);J(Ee,`${`flex ${T?"flex-col items-center":"flex-row items-center justify-center"} gap-8`??""} svelte-1w4i1xc`);var ge=s(Ee),De=s(ge),ht=s(De);He(ht,{get t(){return m().profile_picture},fullSize:!0,ml:"auto",mr:"auto"}),r(De);var Fe=_(De,2),yt=s(Fe,!0);r(Fe),r(ge),B(ge,a=>l(R,a),()=>e(R));var Ue=_(ge,2),kt=s(Ue);{var _t=a=>{var x=lt(),z=s(x);F(z,"src",Rt),r(x),B(x,ie=>l(E,ie),()=>e(E)),L(a,x)};Y(kt,a=>{T||a(_t)})}r(Ue);var It=_(Ue,2);{var St=a=>{var x=ot(),z=s(x),ie=s(z);const je=V(()=>{var N,ne;return(ne=(N=g())==null?void 0:N.opponent)==null?void 0:ne.profile_picture});He(ie,{get t(){return e(je)},fullSize:!0,ml:"auto",mr:"auto"}),r(z);var Be=_(z,2),Tt=s(Be,!0);r(Be),r(x),B(x,N=>l(q,N),()=>e(q)),H(N=>pe(Tt,N),[()=>{var N,ne;return O((ne=(N=g())==null?void 0:N.opponent)==null?void 0:ne.name)}],V),L(a,x)};Y(It,a=>{T||a(St)})}r(Ee),r(qe),r(Re),r(ze),r(xe),r(te),H(a=>{F(re,"style",`background-image: url("${zt}"); transform: scale(${e(d)}); transform-origin: 50% 50%;`),pe(yt,a)},[()=>O(M.username)],V),L(Q,te),ue(),U()}var mt=A("<span> </span>");function ut(Q,n){ce(n,!1);let y=b(n,"min",8,0),U=b(n,"sec",8,0),m=b(n,"start",8,!1),f=b(n,"pause",8,!1),S=b(n,"totalTime",8,0),h=0,g=u(),v=parseInt(y(),10),d=parseInt(U(),10),C=0,D=u(0),I=u(0);const p=be();he(()=>{let M=(y()?parseInt(y(),10):0)*60;M+=U()?parseInt(U(),10):0,h=M,w()});function k(){f()||(h+=1,v=parseInt(h/60,10),d=parseInt(h%60,10),w(),q())}function w(){C=S()-(v*60+d),l(D,parseInt(C/60,10)),l(I,C%60)}function R(){clearInterval(e(g)),v=parseInt(y(),10),d=parseInt(U(),10),h=v*60+d,w(),l(g,setInterval(k,1e3))}function E(){clearInterval(e(g)),l(g,null)}function q(M="timer"){const T=v*60+d,O=T>=S();O&&(clearInterval(e(g)),l(g,null)),p("timerUpdate",{status:O?"completed":M,min:v,sec:d,ticks:T})}We(()=>{clearInterval(e(g))}),le(()=>(me(m()),e(g)),()=>{m()&&!e(g)?R():!m()&&e(g)&&E()}),le(()=>me(f()),()=>{f()}),we(),de();var c=mt(),Z=s(c);r(c),H((M,T)=>pe(Z,`${M??""}:${T??""}`),[()=>Ve(e(D)),()=>Ve(e(I))],V),L(Q,c),ue()}var vt=A('<div><div class="relative cursor-pointer"><div><div><div class="timer-display  absolute top-[15%] left-[35%] text-white text-xl font-bold"><!></div></div></div></div></div>');function dt(Q,n){ce(n,!1);let y=b(n,"playTimer",8,!1),U=b(n,"allowPlaying",8,!0),m=b(n,"timerPause",8,!1),f=b(n,"timeLimit",8,0);b(n,"isFullscreen",8,!1),b(n,"isMcdUser",8,!1);let S=u(!1);const h=be();function g(w,R){h("timerUpdate",{status:w,data:R})}function v(){l(S,!e(S))}de();var d=vt(),C=s(d),D=s(C),I=s(D),p=s(I),k=s(p);ut(k,{min:0,sec:0,get start(){return y()},get pause(){return m()},get totalTime(){return f()},$$events:{timerUpdate:w=>g(w.detail.status,w.detail)}}),r(p),r(I),r(D),r(C),r(d),H(()=>{J(d,`timer-box absolute z-[2000] top-0 left-1/2 transform -translate-x-1/2
         ${(y()||!U()?"":"hidden")??""}`),J(D,`timer-container ${(e(S)?"translate-y-0":"-translate-y-6")??""} transition-transform duration-500 svelte-qy2iho`),J(I,`timer-bubble px-5 py-2 flex items-center justify-center ${(e(S)?"timer-open":"timer-closed")??""} svelte-qy2iho`)}),Mt("click",C,v),L(Q,d),ue()}var pt=A('<div class="loader-container svelte-ihhr1v"><!></div>'),ft=A('<div class="timer-overlay svelte-ihhr1v"><!></div>'),xt=A('<div class="game-container svelte-ihhr1v"><!> <iframe class="game-iframe svelte-ihhr1v" allow="fullscreen" title="Game Player" scrolling="no" webkitallowfullscreen="true" allowFullScreen="" mozallowfullscreen="true"></iframe></div> <div class="modal-container svelte-ihhr1v"><!></div>',1);Xe=function(Q,n){ce(n,!1);const[y,U]=Ge(),m=()=>ve(Dt,"$gameDataStore",y),f=()=>ve(Ke,"$userStore",y),S=()=>ve(Le,"$userActivityStore",y),h=()=>ve(Ft,"$t",y),g=u();b(n,"userData",8),b(n,"gameData",8);let v=u(),d=u(!0),C=!1,D=u(300),I=u(!0),p=u(!1),k=u(0),w=u(!1),R=u(!1);const E=be();let q=0,c={answer:[],totalCorrect:0,totalContinuousCorrect:0,totalContinuousWrong:0,totalAttempted:0,totalQuestions:0,timeInSec:0,singleQuestionTime:0,mistakes:0,score:0};function Z(t){const i=[...c.answer],o=c.singleQuestionTime?(Date.now()-c.singleQuestionTime)/1e3:(Date.now()-q)/1e3;i.push({index:t.index,is_correct:t.correct,time_take:o});const $=t.correct?c.totalCorrect+1:c.totalCorrect,j=t.correct?c.totalContinuousCorrect+1:0,P=t.correct?0:c.totalContinuousWrong+1,re=t.attempted||i.length;c={...c,answer:i,totalCorrect:$,totalContinuousCorrect:j,totalContinuousWrong:P,totalAttempted:re,singleQuestionTime:Date.now(),mistakes:typeof t.mistakes>"u"?c.mistakes:t.mistakes,score:$*100},E("gameDataUpdate",c)}function M(){return{score:c.totalCorrect*100,total_questions:c.totalQuestions,total_correct:c.totalCorrect,total_attempted:c.totalAttempted,total_time_spent:c.timeInSec+1,question_data:[...c.answer],mistakes:c.mistakes}}function T(t){var i,o,$,j,P,re;Bt({playerName:f().name,accuracy:Kt(t.total_correct,t.total_attempted,t.total_questions),timeTaken:t.total_time_spent,avatar:f().profile_picture,total_correct:t==null?void 0:t.total_correct}),Ot({playerName:(o=(i=m())==null?void 0:i.opponent)==null?void 0:o.name,avatar:(j=($=m())==null?void 0:$.opponent)==null?void 0:j.profile_picture,opponent_id:(re=(P=m())==null?void 0:P.opponent)==null?void 0:re.user_id})}function O(){var i,o;const t=M();if(T(t),!((i=f())!=null&&i.is_guest_mode))Qt(m().subjectData,t);else{const $=Nt(t.total_correct,t.total_attempted,t.total_questions,m().subjectData.base_points),j=+((o=Vt(Le))==null?void 0:o.total_coins_earned)+$;console.log($,j,t,S(),m(),"pointsGained"),Le.set({total_coins_earned:Pt(j,2)}),Xt.update(P=>({...P,points:j})),Ht("/challenge/result")}}function X(t){try{const{message:i,data:o}=JSON.parse(t.data);switch(i){case"LOADING":l(k,o);break;case"START":C=!0,c.totalQuestions=o,l(I,!0),q=Date.now(),c.singleQuestionTime=Date.now(),e(v)&&Oe(v,e(v).style.display="block"),E("gameEvent",{type:"START",data:o});break;case"SUBMIT_QUESTION":Z({index:o.index,correct:o.correct,attempted:o.attempted,mistakes:o.mistakes}),E("gameEvent",{type:"SUBMIT_QUESTION",data:c});break;case"STOP":O();break;case"RESIGN":l(w,!0);break;case"gameError":l(I,!1),e(v)&&Oe(v,e(v).style.display="none"),E("gameEvent",{type:"gameError",data:o});break;case"PAUSE":l(p,!0),E("gameEvent",{type:"PAUSE",data:o});break;case"RESUME":l(p,!1),E("gameEvent",{type:"RESUME",data:o});break;default:E("gameEvent",{type:i,data:o});break}}catch(i){console.error("Error processing message:",i)}}function G(t){const{status:i,data:o}=t.detail;console.log(i,"status"),i==="completed"&&O()}function ye(t){const{value:i,orientation:o}=t.detail;l(R,i),E("screenChange",{fullscreen:i,orientation:o})}function ee(){return setInterval(()=>{!e(p)&&C&&(c.timeInSec=Math.floor((Date.now()-q)/1e3))},1e3)}function ke(){const t=M();T(t),Gt(m().subjectData,t)}function _e(t){t==="timeToStart"&&l(d,!1)}he(()=>{var i;window.addEventListener("message",X),(i=m())!=null&&i.time_limit&&l(D,m().time_limit);const t=ee();return()=>{window.removeEventListener("message",X),clearInterval(t)}}),le(()=>(m(),f()),()=>{l(g,`${m().link}&user_id=${f().user_id}&isPlayBonzo=1`)}),le(()=>m(),()=>{console.log(m(),"gameDataStore")}),we(),de();var te=xt(),W=Et(te),fe=s(W);{var ae=t=>{var i=pt(),o=s(i);ct(o,{get userData(){return f()},get gameData(){return m()},callback:_e,get percent(){return e(k)},set percent($){l(k,$)},$$legacy:!0}),r(i),H(()=>Ae(i,"fade-out",!e(d))),L(t,i)},Ie=t=>{var i=ft(),o=s(i);dt(o,{get playTimer(){return e(I)},allowPlaying:!0,get timerPause(){return e(p)},get timeLimit(){return e(D)},get isFullscreen(){return e(R)},$$events:{timerUpdate:G,handleScreen:ye}}),r(i),L(t,i)};Y(fe,t=>{e(d)?t(ae):t(Ie,!1)})}var K=_(fe,2);B(K,t=>l(v,t),()=>e(v)),r(W);var oe=_(W,2),xe=s(oe);{var se=t=>{const i=V(()=>h()("resign_title")),o=V(()=>h()("resign_message")),$=V(()=>h()("cancel")),j=V(()=>h()("resign_text"));qt(t,{get title(){return e(i)},get message(){return e(o)},get cancelText(){return e($)},get successText(){return e(j)},onConfirm:ke,get showModal(){return e(w)},set showModal(P){l(w,P)},$$legacy:!0})};Y(xe,t=>{e(w)&&t(se)})}r(oe),H(()=>{F(K,"src",e(g)),Ae(K,"fade-in",!e(d)),Ae(oe,"pointer-events-auto",e(w))}),L(Q,te),ue(),U()}});export{Yt as __tla,Xe as component};
