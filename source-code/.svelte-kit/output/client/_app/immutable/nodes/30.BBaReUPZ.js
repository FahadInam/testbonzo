import"../chunks/BDr9Qe-U.js";import"../chunks/69_IOA4Y.js";import{p as ie,l as le,g as e,m as d,F as ve,d as he,c as o,r as i,a as ne,b as r,u as Mt,t as F,f as qe,s as I,n as Qt,e as V,aP as Be}from"../chunks/BWmI7Kwv.js";import{t as z,a as E,e as Oe}from"../chunks/cR8EBM7j.js";import{i as B,a as ee,s as Ge}from"../chunks/DJyY-Ao_.js";import{s as O}from"../chunks/Dui37nOO.js";import{s as G,t as Pe}from"../chunks/CQjx5DEQ.js";import{b as te}from"../chunks/CzvvLib5.js";import{i as ce}from"../chunks/CvLKQSYC.js";import{p as k}from"../chunks/Dtj4eyj4.js";import{c as ye,o as pe,a as We}from"../chunks/DjNUT-oc.js";import{u as Je,t as He}from"../chunks/Bvbqq-zN.js";import{g as Ft}from"../chunks/Bz4n4I_X.js";import{s as me}from"../chunks/CpvBVgdC.js";import{s as Lt,a as Nt,p as Rt,b as qt,c as Bt,v as Ot}from"../chunks/_Vcui5w2.js";import{A as Ve}from"../chunks/DrO32kRC.js";import{e as Gt}from"../chunks/Cio8JTVh.js";import{z as Xe}from"../chunks/DWJ43-ZD.js";import{C as Wt}from"../chunks/EsZdy3dr.js";import{d as Jt,e as Ht,a as Ue,b as Vt,R as Xt,__tla as Yt}from"../chunks/DqqvuqO8.js";import{A as Kt,__tla as Zt}from"../chunks/BOfNRF_K.js";import{g as Ye}from"../chunks/BoEBYeq-.js";import{g as ea}from"../chunks/C_S5TygX.js";import{u as ze}from"../chunks/Q_rB2KR5.js";import"../chunks/DxGJWrS1.js";import"../chunks/CbiYp799.js";import"../chunks/CJxW89IG.js";import{g as Ke}from"../chunks/CkIfqAOp.js";let Ze,ta=Promise.all([(()=>{try{return Yt}catch{}})(),(()=>{try{return Zt}catch{}})()]).then(async()=>{const et=""+new URL("../assets/start_challenge.B-lbAoXm.mp3",import.meta.url).href,tt=""+new URL("../assets/drumroll.DMT6Sqnq.mp3",import.meta.url).href,at=""+new URL("../assets/countdown.Cbs6QFWp.mp3",import.meta.url).href;var st=z("<span> </span>"),rt=z('<div class="timer svelte-celqh7"><!></div>');function ot(L,l){ie(l,!1);let h=k(l,"start",8,!1),P=k(l,"callback",8),n=d(3),g,b=d(!1),D=d(!1),v=d(!1);const _=ye();function m(){r(b,!0),r(n,3),r(v,!1),w(),_("mount"),g=setInterval(()=>{Mt(n,-1),e(n)===0?(r(v,!0),w(),setTimeout(()=>{r(b,!1),r(v,!1),P()&&P()()},1e3),clearInterval(g)):w()},1e3)}function w(){r(D,!1),setTimeout(()=>{r(D,!0)},50)}pe(()=>()=>{g&&clearInterval(g)}),le(()=>(ve(h()),e(b)),()=>{h()&&!e(b)&&m()}),he(),ce();var $=rt(),U=o($);{var C=x=>{var p=st(),S=o(p,!0);i(p),F(()=>{G(p,`count ${(e(D)?"animated":"")??""} svelte-celqh7`),me(S,e(v)?0:e(n))}),E(x,p)};B(U,x=>{h()&&(e(n)>0||e(v))&&x(C)})}i($),E(L,$),ne()}var it=z('<img alt="Sword 2">'),lt=z('<img alt="Sword 1"> <!>',1),nt=z('<div class="relative w-full h-[84px]"><!></div>');function ct(L,l){ie(l,!1);let h=k(l,"isSinglePlayerMatch",8,!1),P=d(!1),n=d(!1),g=d(!1);pe(()=>{setTimeout(()=>{r(P,!0),setTimeout(()=>{r(n,!0),r(g,!0)},50)},3e3)}),ce();var b=nt(),D=o(b);{var v=_=>{var m=lt(),w=qe(m);O(w,"src",Lt);var $=I(w,2);{var U=C=>{var x=it();O(x,"src",Nt),F(()=>G(x,`absolute left-[10px] top-4.5 md:-top-[1px] h-[58px] w-[64px] md:h-[84px] md:w-[90px] transform rotate-8 z-20 sword2-rotate ${(e(g)?"animate":"")??""} svelte-c46ct3`)),E(C,x)};B($,C=>{h()||C(U)})}F(()=>G(w,`absolute -left-1 top-4.5 md:top-0 h-[58px] w-[64px] md:h-[84px] md:w-[90px] z-20 sword-rotate ${(e(n)?"animate":"")??""} svelte-c46ct3`)),E(_,m)};B(D,_=>{e(P)&&_(v)})}i(b),E(L,b),ne()}var mt=z('<div class="flex-1 h-1/2 w-full bg-transparent animated-right svelte-j692io" style="border: 12px solid black; background: radial-gradient(at top, #FF981E 0%, #CB1E47 60%);"></div>'),ut=z('<div class="flex items-center gap-4 svelte-j692io"><div class="text-white font-bold text-xl svelte-j692io">Loading...</div> <div class="text-white text-[60px] font-bold pb-[0.5rem] svelte-j692io"> <span class="text-white font-bold text-xl svelte-j692io">%</span></div></div>'),dt=z('<div class="mode-text flex gap-2 items-center svelte-j692io"><span></span> <!></div>'),vt=z('<div class="h-32 w-full flex justify-center items-center svelte-j692io"><img alt="VS" class="w-[165px] h-[165px] z-[120] svelte-j692io"></div>'),pt=z('<div class="flex flex-col items-center svelte-j692io"><div class="h-[120px] w-[120px] rounded-full overflow-hidden bg-[#e5e5e5] relative p-2 svelte-j692io"><!></div> <div class="text-center mt-2 font-bold text-white text-lg svelte-j692io"> </div></div>'),ft=z('<div class="flex flex-col h-full w-full justify-center items-center text-red-500 absolute z-10 transition-width duration-300 svelte-j692io"><audio preload="auto" class="svelte-j692io"><source type="audio/mp3" class="svelte-j692io"></audio> <audio preload="auto" class="svelte-j692io"><source type="audio/mp3" class="svelte-j692io"></audio> <audio preload="auto" class="svelte-j692io"><source type="audio/mp3" class="svelte-j692io"></audio> <div class="h-full w-full fixed top-0 bg-black svelte-j692io"><div><div style="background: radial-gradient(at bottom, #00F0FF 0%, #1C62CB 60%);"></div> <!></div> <div class="max-h-screen max-w-full overflow-hidden h-full w-full fixed left-0 top-0 bottom-0 right-0 svelte-j692io"><div class="svelte-j692io"><div class="absolute left-0 right-0 top-0 bottom-0 bg-cover bg-center svelte-j692io"></div> <div class="absolute left-0 right-0 top-0 bottom-0 bg-cover bg-center transition-transform duration-0 svelte-j692io"></div></div></div> <div class="justify-center items-center flex-col h-full m-0 flex absolute top-0 bottom-0 right-0 left-0 overflow-hidden h-full max-h-full svelte-j692io"><div class="justify-center items-center flex-col h-full m-0 flex w-full max-w-5xl justify-between svelte-j692io"><div class="relative w-full flex justify-center mt-10 svelte-j692io"><div class="relative bg-contain bg-center bg-no-repeat h-[85px] w-[350px] md:w-[430px] svelte-j692io"><!> <div class="absolute w-full h-full flex items-center justify-center top-0 svelte-j692io"><!></div></div></div> <div class="mt-6 mb-6 w-full max-w-4xl svelte-j692io"><div><div class="flex flex-col items-center svelte-j692io"><div class="h-[120px] w-[120px] rounded-full overflow-hidden bg-[#e5e5e5] relative p-2 svelte-j692io"><!></div> <div class="text-center mt-2 font-bold text-white text-lg svelte-j692io"><!></div></div> <div class="flex flex-col items-center justify-center svelte-j692io"><!></div> <!></div></div></div></div></div></div>');function gt(L,l){var Le,Ne;ie(l,!1);const[h,P]=Ge(),n=()=>ee(Je,"$userStore",h),g=()=>ee(He,"$t",h);let b=k(l,"percent",8,0),D=k(l,"callback",8),v=k(l,"userData",8),_=k(l,"gameData",8),m=k(l,"isHundredReached",12,!1),w=d(1),$=d(!1),U=!1,C=!1,x=d(),p=d(),S=d(),W=d(),A=d(),M=d();const f={username:(Le=v())==null?void 0:Le.name},j=((Ne=_())==null?void 0:Ne.isSinglePlayer)===0;function R(a){return a?a.length>12?a.substring(0,10)+"...":a:""}function q(a){a==="track3"?(e(x)&&e(x).pause(),e(p)&&e(p).pause(),e(S)&&e(S).play()):(a==="track1"&&e(x)&&e(x).play(),a==="track2"&&e(p)&&e(p).play())}function J(a){a==="track1"&&e(x)&&e(x).pause(),a==="track2"&&e(p)&&e(p).pause(),a==="track3"&&e(S)&&e(S).pause()}function fe(){return 1+(Math.random()*9+1)/10}function ae(a,c,T,K,Ce){a&&setTimeout(()=>{a.classList.add(c),setTimeout(()=>{a.classList.remove(c)},T)},Ce)}pe(()=>{const a=setInterval(()=>{r(w,fe())},400);return e(W)&&ae(e(W),"animate-slideInLeft",350,!1,500),e(M)&&(ae(e(M),"animate-slideInRight",350,!1,500),ae(e(A),"animate-fadeIn",750,!1,950),ae(e(A),"animate-jello",750,!1,1200)),!j&&!U&&setTimeout(()=>{q("track1"),U=!0},0),C||setTimeout(()=>{q("track2"),C=!0},2500),()=>{J("track1"),J("track2"),J("track3"),clearInterval(a)}});function _e(){D()("timeToStart")}function ke(){q("track3"),r($,!0)}We(()=>{J("track1"),J("track2"),J("track3")}),le(()=>(ve(b()),ve(m())),()=>{b()>=100&&!m()&&(m(!0),setTimeout(()=>{q("track3"),r($,!0)},500))}),he(),ce();var ue=ft(),se=o(ue),ge=o(se);O(ge,"src",et),i(se),te(se,a=>r(x,a),()=>e(x));var X=I(se,2),xe=o(X);O(xe,"src",tt),i(X),te(X,a=>r(p,a),()=>e(p));var re=I(X,2),je=o(re);O(je,"src",at),i(re),te(re,a=>r(S,a),()=>e(S));var oe=I(re,2),Y=o(oe);G(Y,`${`justify-center items-center flex-col h-full m-0 flex ${j?"twisted-ui-s":"twisted-ui"}`??""} svelte-j692io`);var be=o(Y);G(be,`${`flex-1 ${j?"h-full":"h-1/2"} w-full bg-transparent ${j?"":"animated-left"}`??""} svelte-j692io`);var $e=I(be,2);{var t=a=>{var c=mt();E(a,c)};B($e,a=>{j||a(t)})}i(Y);var s=I(Y,2),y=o(s),u=o(y);O(u,"style",`background-image: url("${Rt}")`);var Q=I(u,2);i(y),i(s);var N=I(s,2),Z=o(N),Se=o(Z),Te=o(Se);O(Te,"style",`background-image: url("${qt}")`);var Ae=o(Te);ct(Ae,{isSinglePlayerMatch:j});var Me=I(Ae,2),jt=o(Me);{var $t=a=>{var c=ut(),T=I(o(c),2),K=o(T,!0);Qt(),i(T),i(c),F(()=>me(K,b())),E(a,c)},St=a=>{var c=dt(),T=o(c);G(T,`text-white font-bold ${(j?"text-base md:text-lg":"text-base md:text-xl")??""} svelte-j692io`),T.textContent=`${(j?"Single Player Mode":"Challenge Mode")??""} in`;var K=I(T,2);ot(K,{start:!0,callback:_e,$$events:{mount:ke}}),i(c),E(a,c)};B(jt,a=>{b()>=0&&!m()?a($t):a(St,!1)})}i(Me),i(Te),i(Se);var Qe=I(Se,2),Ie=o(Qe);G(Ie,`${`flex ${j?"flex-col items-center":"flex-row items-center justify-center"} gap-8`??""} svelte-j692io`);var we=o(Ie),Ee=o(we),Tt=o(Ee);Ve(Tt,{get t(){return n().profile_picture},fullSize:!0,ml:"auto",mr:"auto"}),i(Ee);var Fe=I(Ee,2),It=o(Fe);{var Et=a=>{var c=Oe();F(T=>me(c,T),[()=>R(f.username)],V),E(a,c)},Dt=a=>{var c=Oe();F(T=>me(c,T),[()=>g()("guest_mode")],V),E(a,c)};B(It,a=>{var c;(c=n())!=null&&c.is_guest_mode?a(Dt,!1):a(Et)})}i(Fe),i(we),te(we,a=>r(W,a),()=>e(W));var De=I(we,2),Ct=o(De);{var Pt=a=>{var c=vt(),T=o(c);O(T,"src",Ot),i(c),te(c,K=>r(A,K),()=>e(A)),E(a,c)};B(Ct,a=>{j||a(Pt)})}i(De);var Ut=I(De,2);{var zt=a=>{var c=pt(),T=o(c),K=o(T);const Ce=V(()=>{var H,de;return(de=(H=_())==null?void 0:H.opponent)==null?void 0:de.profile_picture});Ve(K,{get t(){return e(Ce)},fullSize:!0,ml:"auto",mr:"auto"}),i(T);var Re=I(T,2),At=o(Re,!0);i(Re),i(c),te(c,H=>r(M,H),()=>e(M)),F(H=>me(At,H),[()=>{var H,de;return R((de=(H=_())==null?void 0:H.opponent)==null?void 0:de.name)}],V),E(a,c)};B(Ut,a=>{j||a(zt)})}i(Ie),i(Qe),i(Z),i(N),i(oe),i(ue),F(()=>O(Q,"style",`background-image: url("${Bt}"); transform: scale(${e(w)}); transform-origin: 50% 50%;`)),E(L,ue),ne(),P()}var xt=z("<span> </span>");function bt(L,l){ie(l,!1);let h=k(l,"min",8,0),P=k(l,"sec",8,0),n=k(l,"start",8,!1),g=k(l,"pause",8,!1),b=k(l,"totalTime",8,0),D=0,v=d(),_=parseInt(h(),10),m=parseInt(P(),10),w=0,$=d(0),U=d(0);const C=ye();pe(()=>{let j=(h()?parseInt(h(),10):0)*60;j+=P()?parseInt(P(),10):0,D=j,p()});function x(){g()||(D+=1,_=parseInt(D/60,10),m=parseInt(D%60,10),p(),A())}function p(){w=b()-(_*60+m),r($,parseInt(w/60,10)),r(U,w%60)}function S(){clearInterval(e(v)),_=parseInt(h(),10),m=parseInt(P(),10),D=_*60+m,p(),r(v,setInterval(x,1e3))}function W(){clearInterval(e(v)),r(v,null)}function A(j="timer"){const R=_*60+m,q=R>=b();q&&(clearInterval(e(v)),r(v,null)),C("timerUpdate",{status:q?"completed":j,min:_,sec:m,ticks:R})}We(()=>{clearInterval(e(v))}),le(()=>(ve(n()),e(v)),()=>{n()&&!e(v)?S():!n()&&e(v)&&W()}),le(()=>ve(g()),()=>{g()}),he(),ce();var M=xt(),f=o(M);i(M),F((j,R)=>me(f,`${j??""}:${R??""}`),[()=>Xe(e($)),()=>Xe(e(U))],V),E(L,M),ne()}var wt=z('<div><div class="relative cursor-pointer"><div><div><div class="timer-display absolute top-[15%] left-[35%] text-white text-xl font-bold"><!></div></div></div></div></div>');function ht(L,l){ie(l,!1);let h=k(l,"playTimer",8,!1),P=k(l,"allowPlaying",8,!0),n=k(l,"timerPause",8,!1),g=k(l,"timeLimit",8,0);k(l,"isFullscreen",8,!1),k(l,"isMcdUser",8,!1);let b=d(!1);const D=ye();function v(p,S){D("timerUpdate",{status:p,data:S})}function _(){r(b,!e(b))}ce();var m=wt(),w=o(m),$=o(w),U=o($),C=o(U),x=o(C);bt(x,{min:0,sec:0,get start(){return h()},get pause(){return n()},get totalTime(){return g()},$$events:{timerUpdate:p=>v(p.detail.status,p.detail)}}),i(C),i(U),i($),i(w),i(m),F(()=>{G(m,`timer-box absolute z-[2000] top-0 left-1/2 transform -translate-x-1/2
         ${(h()||!P()?"":"hidden")??""}`),G($,`timer-container ${(e(b)?"-translate-y-1/2":"translate-y-0")??""} transition-transform duration-500 svelte-1vku81i`),G(U,`timer-bubble px-5 py-2 flex items-center justify-center ${(e(b)?"timer-open":"timer-closed")??""} svelte-1vku81i`)}),Gt("click",w,_),E(L,m),ne()}var yt=z('<div class="loader-container svelte-1nczyez"><!></div>'),_t=z('<div class="timer-overlay svelte-1nczyez"><!></div>'),kt=z('<div class="game-container svelte-1nczyez"><!> <iframe class="game-iframe svelte-1nczyez" allow="fullscreen" title="Game Player" scrolling="no" webkitallowfullscreen="true" allowFullScreen="" mozallowfullscreen="true"></iframe></div> <div class="modal-container svelte-1nczyez"><!></div>',1);Ze=function(L,l){ie(l,!1);const[h,P]=Ge(),n=()=>ee(Ft,"$gameDataStore",h),g=()=>ee(Je,"$userStore",h),b=()=>ee(ze,"$userActivityStore",h),D=()=>ee(Ke,"$guestStore",h),v=()=>ee(He,"$t",h),_=d();k(l,"userData",8),k(l,"gameData",8);let m=d(),w=d(!0),$=!1,U=d(300),C=d(!0),x=d(!1),p=d(0),S=d(!1),W=d(!1);const A=ye();let M=0,f={answer:[],totalCorrect:0,totalContinuousCorrect:0,totalContinuousWrong:0,totalAttempted:0,totalQuestions:0,timeInSec:0,singleQuestionTime:0,mistakes:0,score:0};function j(t){const s=[...f.answer],y=f.singleQuestionTime?(Date.now()-f.singleQuestionTime)/1e3:(Date.now()-M)/1e3;s.push({index:t.index,is_correct:t.correct,time_take:y});const u=t.correct?f.totalCorrect+1:f.totalCorrect,Q=t.correct?f.totalContinuousCorrect+1:0,N=t.correct?0:f.totalContinuousWrong+1,Z=t.attempted||s.length;f={...f,answer:s,totalCorrect:u,totalContinuousCorrect:Q,totalContinuousWrong:N,totalAttempted:Z,singleQuestionTime:Date.now(),mistakes:typeof t.mistakes>"u"?f.mistakes:t.mistakes,score:u*100},A("gameDataUpdate",f)}function R(){return{score:f.totalCorrect*100,total_questions:f.totalQuestions,total_correct:f.totalCorrect,total_attempted:f.totalAttempted,total_time_spent:f.timeInSec+1,question_data:[...f.answer],mistakes:f.mistakes}}function q(t){var s,y,u,Q,N,Z;Ue({playerName:g().name,accuracy:Kt(t.total_correct,t.total_attempted,t.total_questions),timeTaken:t.total_time_spent,avatar:g().profile_picture,total_correct:t==null?void 0:t.total_correct}),Vt({playerName:(y=(s=n())==null?void 0:s.opponent)==null?void 0:y.name,avatar:(Q=(u=n())==null?void 0:u.opponent)==null?void 0:Q.profile_picture,opponent_id:(Z=(N=n())==null?void 0:N.opponent)==null?void 0:Z.user_id})}function J(){var s,y;const t=R();if(q(t),!((s=g())!=null&&s.is_guest_mode))Jt(n().subjectData,t);else{const u=Ht(t.total_correct,t.total_attempted,t.total_questions,n().subjectData.base_points),Q=+((y=ea(ze))==null?void 0:y.total_coins_earned)+u;console.log(u,Q,t,b(),n(),"pointsGained"),ze.set({total_coins_earned:Q}),Ue({points:u}),Ke.update(N=>({...N,points:Q+D().points})),Ye("/challenge/result")}}function fe(t){try{let s;typeof t.data=="string"?s=JSON.parse(t.data):s=t.data;const{message:y,data:u}=s;switch(y){case"LOADING":r(p,u);break;case"START":$=!0,f.totalQuestions=u,r(C,!0),M=Date.now(),f.singleQuestionTime=Date.now(),r(p,100),e(m)&&Be(m,e(m).style.display="block"),A("gameEvent",{type:"START",data:u});break;case"SUBMIT_QUESTION":j({index:u.index,correct:u.correct,attempted:u.attempted,mistakes:u.mistakes}),A("gameEvent",{type:"SUBMIT_QUESTION",data:f});break;case"STOP":J();break;case"RESIGN":r(S,!0);break;case"gameError":r(C,!1),e(m)&&Be(m,e(m).style.display="none"),A("gameEvent",{type:"gameError",data:u});break;case"PAUSE":r(x,!0),A("gameEvent",{type:"PAUSE",data:u});break;case"RESUME":r(x,!1),A("gameEvent",{type:"RESUME",data:u});break;default:A("gameEvent",{type:y,data:u});break}}catch(s){console.error("Error processing message:",s),console.error("Event data type:",typeof t.data),console.error("Event data:",t.data)}}function ae(t){const{status:s,data:y}=t.detail;console.log(s,"status"),s==="completed"&&J()}function _e(t){const{value:s,orientation:y}=t.detail;r(W,s),A("screenChange",{fullscreen:s,orientation:y})}function ke(){return setInterval(()=>{!e(x)&&$&&(f.timeInSec=Math.floor((Date.now()-M)/1e3))},1e3)}function ue(){var s;const t=R();(s=g())!=null&&s.is_guest_mode?(Ue({score:null,playerName:g().name,accuracy:0,timeTaken:null,avatar:g().profile_picture,total_correct:t==null?void 0:t.total_correct}),Ye("/challenge/result")):(q(t),Xt(n().subjectData,t))}function se(t){t==="timeToStart"&&r(w,!1)}pe(()=>{var s;window.addEventListener("message",fe),(s=n())!=null&&s.time_limit&&r(U,n().time_limit);const t=ke();return()=>{window.removeEventListener("message",fe),clearInterval(t)}}),le(()=>(n(),g()),()=>{r(_,`${n().link}&user_id=${g().user_id}&isPlayBonzo=1`)}),le(()=>n(),()=>{console.log(n(),"gameDataStore")}),he(),ce();var ge=kt(),X=qe(ge),xe=o(X);{var re=t=>{var s=yt(),y=o(s);gt(y,{get userData(){return g()},get gameData(){return n()},callback:se,get percent(){return e(p)},set percent(u){r(p,u)},$$legacy:!0}),i(s),F(()=>Pe(s,"fade-out",!e(w))),E(t,s)},je=t=>{var s=_t(),y=o(s);ht(y,{get playTimer(){return e(C)},allowPlaying:!0,get timerPause(){return e(x)},get timeLimit(){return e(U)},get isFullscreen(){return e(W)},$$events:{timerUpdate:ae,handleScreen:_e}}),i(s),E(t,s)};B(xe,t=>{e(w)?t(re):t(je,!1)})}var oe=I(xe,2);te(oe,t=>r(m,t),()=>e(m)),i(X);var Y=I(X,2),be=o(Y);{var $e=t=>{const s=V(()=>v()("resign_title")),y=V(()=>v()("resign_message")),u=V(()=>v()("cancel")),Q=V(()=>v()("resign_text"));Wt(t,{get title(){return e(s)},get message(){return e(y)},get cancelText(){return e(u)},get successText(){return e(Q)},onConfirm:ue,get showModal(){return e(S)},set showModal(N){r(S,N)},$$legacy:!0})};B(be,t=>{e(S)&&t($e)})}i(Y),F(()=>{O(oe,"src",e(_)),Pe(oe,"fade-in",!e(w)),Pe(Y,"pointer-events-auto",e(S))}),E(L,ge),ne(),P()}});export{ta as __tla,Ze as component};
