import{b as g,h as z}from"./CpOe2gu7.js";import{w as I,g as n}from"./CS3uJLGD.js";import{c as r}from"./zx05KRmR.js";import{g as C}from"./BhqQrrNl.js";import{A as _,__tla as B}from"./xsk9tW-i.js";import{r as d}from"./KMGk3Nas.js";import{u as F}from"./rUUE80t4.js";import"./KgIHh09F.js";import{g as D}from"./Bhxzz1gg.js";import{a as J}from"./CVxajco_.js";import{m as u}from"./Buhwy7Lv.js";let G,P,H,k,v,L,S,p,O,R,V,x,M,Y,y,K=Promise.all([(()=>{try{return B}catch{}})()]).then(async()=>{let f;f={player:{name:"Player",avatar:null,score:"0",accuracy:"0%",timeTaken:"0s"},opponent:{name:"Opponent",avatar:null,score:"0",accuracy:"-",timeTaken:"-"},gameStatus:{isWinner:!1,isCompleted:!1,statusText:"Ongoing"}},p=I(f),M=function(){p.set(f)},L=function(t){p.update(a=>({...a,player:{...a.player,...t}}))},S=function(t){p.update(a=>({...a,opponent:{...a.opponent,...t}}))},y=I({total_coins_earned:0}),V=async function(){await g();const t=n(r).current_grade,a=n(r).competition_id,e=n(C).subject;return await d(_.CHALLENGE_FRIENDS,{competition_id:a,grade:t,subject:e},{})},k=async function(t,a,e){await g();const o=n(r).current_grade,i=n(r).competition_id,{subject:c,content_id:s,type:m}=t;return console.log({competition_id:i,grade:o,subject:c,content_id:s,friend_id:a.user_id||a.id,is_game:1,content_type:m}),await d(_.CHALLENGE_START,{competition_id:i,grade:o,subject:c,content_id:s,...e===1?{friend_id:a.user_id||a.id}:{},is_game:1,content_type:m},{})},P=async function(t){await g();const a=n(r).current_grade,e=n(r).competition_id,{subject:o,match_id:i}=t;return await d(_.CHALLENGE_PLAY,{competition_id:e,grade:a,match_id:i,subject:o},{})},H=async function(t,a){console.log(t,a,"subjectData");const e=n(u).current_grade,o=n(u).id,i=n(u).url,{summary_id:c,content_id:s,match_id:m}=t,{question_data:E,total_questions:b,total_correct:A,total_attempted:w,total_time_spent:l}=a,j=await d(_.CHALLENGE_SAVE,{competition_id:o,grade:e,match_id:m,summary_id:c,is_resigned:1,content_id:s,total_questions:b,total_correct:A,total_attempted:w,total_time_spent:l,question_data:{data:E}},{});j.error_code===0&&(p.update(q=>{var N;return{...q,player:{...q.player,score:(N=j.data)==null?void 0:N.my_score}}}),console.log("url",i),D(`/competitions/${i}`),J("You have resigned the match"))},O=async function(t,a){await g();const e=n(u).current_grade,o=n(u).id,{summary_id:i,content_id:c,match_id:s}=t,{question_data:m,total_questions:E,total_correct:b,total_attempted:A,total_time_spent:w}=a,l=await d(_.CHALLENGE_SAVE,{competition_id:o,grade:e,match_id:s,summary_id:i,is_resigned:0,content_id:c,total_questions:E,total_correct:b,total_attempted:A,total_time_spent:w,question_data:{data:m}},{});l.error_code===0&&T(l.data)};let T,h;T=t=>{var o;const a=(o=n(y))==null?void 0:o.total_coins_earned,e=+a+(t==null?void 0:t.points_earned);L({score:t==null?void 0:t.my_score,points:t==null?void 0:t.points_earned}),S({score:t==null?void 0:t.opponent_score,accuracy:h(t==null?void 0:t.opponent_total_correct,t==null?void 0:t.opponent_total_questions,t==null?void 0:t.opponent_total_questions),timeTaken:t==null?void 0:t.opponent_time_spent}),console.log(e,a,t==null?void 0:t.points_earned,"points_earned"),y.set({total_coins_earned:z(e,2)}),D("/challenge/result")},G=t=>{var a;return((a=n(F))==null?void 0:a.user_id)===t||t<1},h=(t,a,e)=>{let o=a;return a<5&&a<e&&(o=5),t/o},R=(t,a,e,o)=>h(t,a,e)*o,v=function({opponent:t,playMode:a,matchData:e,subjectData:o,matchingItem:i={},link:c}){console.log(i,"matchingItem"),C.update(s=>({...s,...i,...a===1&&{opponent:t},isSinglePlayer:a,matchData:e,subjectData:{summary_id:e==null?void 0:e.summary_id,match_id:e==null?void 0:e.match_id,content_id:(o==null?void 0:o.content_id)||(s==null?void 0:s.content_id),base_points:o==null?void 0:o.base_points},link:c}))},x=async function(t){const{row_id:a,match_id:e}=t,o=n(r).competition_id;await d(_.CHALLENGE_INVITATION_STATUS,{competition_id:o,row_id:a,match_id:e,status:1})},Y=async function(t){const{competition_id:a,grade:e,points:o}=t;await d(_.SET_GRADE_POINTS,{competition_id:a,grade:e,points:o})}});export{G as I,P,H as R,k as S,K as __tla,v as a,L as b,S as c,p as d,O as e,R as f,V as g,x as i,M as r,Y as s,y as u};
