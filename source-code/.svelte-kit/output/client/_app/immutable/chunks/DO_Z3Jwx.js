import{r as c}from"./KMGk3Nas.js";import{a as q,u as p,b as l,c as L,d as P,i as U,v as j}from"./CpOe2gu7.js";import{g as i}from"./CS3uJLGD.js";import{A as s,__tla as z}from"./xsk9tW-i.js";import{u}from"./rUUE80t4.js";import{c as a}from"./zx05KRmR.js";import{g as B}from"./Bhxzz1gg.js";import{g as d}from"./KgIHh09F.js";import{I as m}from"./CUEp9C6H.js";import{s as f}from"./CVxajco_.js";import{refreshUserToken as F,__tla as G}from"./LAhWfPf4.js";import{a as Y,i as E}from"./DAxMji9q.js";let w,S,I,g,y,A,D,N,O,R,T,b,h,H,M,k,v,Z=Promise.all([(()=>{try{return z}catch{}})(),(()=>{try{return G}catch{}})()]).then(async()=>{w=async function(){var r;const e=!i(u).is_guest_mode,t=i(a).is_lesson_page_hide==0,o=i(a).is_games_page==1;return[{icon:m.SIDE_NAV_HOME,label:await d("home"),link:"{competitionHome}/home",isRequired:!0},...((r=i(a))==null?void 0:r.is_games_page)==1?[{icon:m.SIDE_NAV_MY_GAMES,label:await d("my_games"),link:"{competitionHome}/my-games"}]:[],{icon:m.SIDE_NAV_LESSON,label:await d("lessons"),link:"{competitionHome}/lessons"},{icon:m.SIDE_NAV_FRIENDS,label:await d("friends"),link:"{competitionHome}/friends"},{icon:m.SIDE_NAV_LEADERBOARD,label:await d("leaderboard"),link:"{competitionHome}/leaderboard",isRequired:!0},{icon:m.SIDE_NAV_REWARDS,label:await d("rewards"),link:"{competitionHome}/rewards",isRequired:!0}].filter(n=>n.isRequired||n.link==="{competitionHome}/friends"&&e||n.link==="{competitionHome}/lessons"&&t||n.link==="{competitionHome}/my-games"&&o)},S=async function(){await q();const{active_role:e}=i(u),t=e==="principal"?s.INSTITUTION_COMPETITIONS:s.COMPETITIONS,o=await c(t,{});return await C(o),o};async function C(e){const{active_role:t,is_guest_mode:o,timezone:r}=i(u),n=t==="principal";if(!(e.error_code===0&&!n&&!o&&Y&&!r))return;const _=Intl.DateTimeFormat().resolvedOptions().timeZone;(await c(s.UPDATE_TIMEZONE,{timezone:_},{})).error_code===0&&p(u,"timezone",_)}k=async function(){await P();const e=i(U).instance_id;return await c(s.DEMO_COMPETITIONS,{},{headers:{instance_id:e}})},g=async function(){await L(a,"competition_id");const e=i(a).competition_id;return await c(s.COMPETITION_DETAILS,{competition_id:e},{})},h=function(e){const t=new Set;return e.reduce((o,r)=>(t.has(r.grade)||(t.add(r.grade),o.push({value:r.grade,label:r.grade_alias,sort_order:r.sort_order})),o.some(n=>n.sort_order!==null)&&(o=o.sort((n,_)=>n.sort_order!==null&&_.sort_order!==null?n.sort_order-_.sort_order:0)),o),[])},M=function(e){return!e||e.length===0?[]:[...new Set(e.map(t=>t.subject))].map(t=>({value:t,label:t}))},v=async function(e){const t=i(u).is_guest_mode,o=i(a);t?p(a,"current_grade",e):(await c(s.SETTINGS_UPDATE,{competition_id:i(a).competition_id,grade:e,points:0,school_id:0,friend_id:0}),p(a,"current_grade",e)),console.log(i(a)),B("/competitions/"+o.url+"/home")},R=async function(){await l();const e=i(a).current_grade,t=i(a).competition_id;return await c(s.LESSON_RECOMMENDATION,{competition_id:t,grade:e},{})},T=async function(){await l();const e=i(a).current_grade,t=i(a).competition_id;return await c(s.COMPETITION_ACTIVITIES,{competition_id:t,grade:e},{})},b=async function(e,t){await l();const o=i(a).current_grade,r=i(a).competition_id;return await c(s.LEARNER_LEADERBOARD,{competition_id:r,grade:o,time_type:e,is_school_based:t},{})},A=async function(e){await l();const t=i(a).current_grade,o=i(a).competition_id;return await c(s.FRIENDS,{competition_id:o,grade:t,subject:e},{})},N=async function(e){await l();const t=i(a).current_grade,o=i(a).competition_id;return await c(s.SEARCH_FRIENDS,{competition_id:o,grade:t,username:e},{})},y=async function(){await l();const e=i(a).current_grade,t=i(a).competition_id;return await c(s.USER_LESSONS,{competition_id:t,grade:e},{})},I=async function(e,t,o){if(!await V(e))return;let r=E?s.ADD_GCLC_VOUCHER:s.ADD_VOUCHER,n={secret_code:e,...E&&{competition_id:o}};(await c(r,n)).error_code===0&&await F(async()=>{t()})};async function V(e){if(!e)f(await d("code_required"));else if(!j(e))f(await d("code_required_alpha_numeric"));else if(e.length<3)f(await d("code_length"));else return!0;return!1}D=async function(){return[{icon:m.SIDE_NAV_HOME,label:await d("overview"),link:"{competitionHome}/overview",isRequired:!0},{icon:m.SIDE_NAV_LEADERBOARD,label:await d("players"),link:"{competitionHome}/players",isRequired:!0}].filter(e=>e.isRequired)},H=async function(){await l();const e=i(a).current_grade,t=i(a).competition_id;return await c(s.MY_GAMES,{competition_id:t,grade:e,page:1},{})},O=async function(){var n;const e=await g(),t=i(a).current_grade;if(!((n=e==null?void 0:e.data)!=null&&n.grades)||!Array.isArray(e.data.grades))return[{value:"",label:"Select Subject"}];const o=e.data.grades.filter(_=>_.grade===t),r=[...new Set(o.map(_=>_.subject))];return[{value:"",label:"Select Subject"},...r.map(_=>({value:_,label:_}))]}});export{Z as __tla,w as a,S as b,I as c,g as d,y as e,A as f,D as g,N as h,O as i,R as j,T as k,b as l,h as m,H as n,M as o,k as p,v as s};
