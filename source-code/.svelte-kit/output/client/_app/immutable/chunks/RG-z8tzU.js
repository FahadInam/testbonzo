const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./3hQXMHQA.js","./BoEBYeq-.js","./DjNUT-oc.js","./BWmI7Kwv.js","./DIeogL5L.js","./C_S5TygX.js","./CR2liGHp.js","./Bvbqq-zN.js","./DWJ43-ZD.js","./DxGJWrS1.js","./D6ovqnLS.js","./CROUG2YM.js","./Bg1yBDra.js","./CbiYp799.js","./CJxW89IG.js","./_Vcui5w2.js","./E8PaDAPB.js","./Djyhf4cp.js","./ClXJh1T-.js","../assets/toast.KOmfmGu7.css","./D7NkiQyh.js","./CkIfqAOp.js","./DqqvuqO8.js","./Bz4n4I_X.js","./Q_rB2KR5.js","./CuKIkSf6.js","./BwH_vxp2.js"])))=>i.map(i=>d[i]);
import{_ as q}from"./CmsKOCeN.js";import{g as e,u as b}from"./Bvbqq-zN.js";import{r as g,a as Y,P as c,b as B}from"./CR2liGHp.js";import{w as U,g as p}from"./C_S5TygX.js";import{g as y}from"./BoEBYeq-.js";import{b as H}from"./ClXJh1T-.js";import{A as f,__tla as M}from"./Djyhf4cp.js";import{i as Q,n as h}from"./DWJ43-ZD.js";import{a as W}from"./D7NkiQyh.js";import{r as X}from"./CkIfqAOp.js";import{s as C}from"./CJxW89IG.js";let w,T,I,E,P,R,L,O,K,x,A,V,D,S,d,F,v,N,G,$,Z=Promise.all([(()=>{try{return M}catch{}})()]).then(async()=>{w=U({page:"user-login",visible:!1}),S=U({isVisible:!1,url:""});function j(a){S.set({isVisible:!0,url:a})}F=function(){S.set({isVisible:!1,url:""})},d=U({is_otp_verified:!1,phone_number:null}),G={title:await e("get_started"),fields:[{name:"email",type:"email",label:await e("email"),placeholder:await e("enter_your_email"),required:!0},{name:"password",type:"password",label:await e("password"),placeholder:await e("enter_your_password"),required:!0}],buttons:[{label:await e("signup"),customClass:"w-full",type:"submit"}],enableTurnstile:!0,turnstileSiteKey:c},L={title:await e("get_started"),fields:[{name:"email",type:"email",label:await e("email"),placeholder:await e("enter_your_email"),required:!0}],buttons:[{label:await e("signup"),customClass:"w-full",type:"submit"}],enableTurnstile:!0,turnstileSiteKey:c},E={title:await e("welcome"),fields:[{name:"email",type:"email",label:await e("email"),placeholder:await e("enter_your_email"),required:!0},{name:"password",type:"password",label:await e("password"),placeholder:await e("enter_your_password"),required:!0}],buttons:[{label:await e("login"),type:"submit",customClass:"w-full"}],enableTurnstile:!1,turnstileSiteKey:"site-key"},$=async()=>[{image:"/images/learner-icon.svg",title:await e("a_learner"),description:await e("play_fun_games"),link:"/account/user/signup"},{image:"/images/institute-icon.svg",title:await h("an_institute"),description:await h("empower"),link:"/account/institution/signup"}],I=async()=>[{image:"/images/learner-icon.svg",title:await e("a_learner"),description:await e("play_fun_games"),onClick:()=>{w.set({visible:!0,page:"user-signup"})}},{image:"/images/institute-icon.svg",title:await h("an_institute"),description:await h("empower"),onClick:()=>{w.set({visible:!0,page:"institution-signup"})}}],D={title:await e("forgot_password"),fields:[{name:"email",type:"email",label:await e("email"),placeholder:await e("enter_your_email"),required:!0}],buttons:[{label:await e("send_reset_link"),type:"submit",customClass:"w-full"}],enableTurnstile:!0,turnstileSiteKey:c},N={title:await e("reset_password"),fields:[{name:"password",type:"password",label:await e("enter_new_password"),placeholder:await e("enter_your_new_password"),required:!0},{name:"confirmPassword",type:"password",label:await e("confirm_new_password"),placeholder:await e("re_enter_new_password"),required:!0}],buttons:[{label:await e("reset_password"),type:"submit",customClass:"w-full"}],enableTurnstile:!1,turnstileSiteKey:"site-key"},P={title:await e("get_started"),fields:[{name:"password",type:"password",label:await e("password"),placeholder:await e("password"),required:!0}],buttons:[{label:await e("signup"),type:"submit",customClass:"w-full"}],footer:{text:await e("already_account"),button:{label:await e("login"),type:"secondary-outlined-inverted",link:"/account/user/login"}},handleSubmit:async a=>{z(a)},enableTurnstile:!0,turnstileSiteKey:c},x={title:await e("welcome"),fields:[{name:"phone_number",type:"tel",label:await e("phone_number"),prefix:"+254",required:!0,placeholder:await e("enter_phone_number")},{name:"password",type:"password",label:await e("password"),placeholder:await e("enter_your_password"),required:!0}],buttons:[{label:await e("login"),type:"submit",customClass:"w-full"}],enableTurnstile:!1,turnstileSiteKey:"site-key"},A={title:await e("enter_phone_number_continue"),fields:[{name:"phone_number",type:"tel",label:await e("phone_number"),prefix:"+254",required:!0,placeholder:await e("enter_phone_number")}],buttons:[{label:await e("signup"),type:"submit",customClass:"w-full"}],enableTurnstile:!0,turnstileSiteKey:c},T={title:await e("confirm_your_number"),fields:[{name:"otp",type:"text",label:await e("otp_code"),placeholder:await e("enter_code"),required:!0},{name:"password",type:"password",label:await e("password"),placeholder:await e("password"),required:!0,isShow:!1}],buttons:[{label:await e("verify"),type:"submit",customClass:"w-full"}],footer:{text:await e("already_account"),button:{label:await e("login"),type:"secondary-outlined-inverted",link:"/account/user/login"}},handleSubmit:async a=>{const{is_otp_verified:t,phone_number:i}=p(d);if(t){const s={...a,phone_number:i,username:""},{signUpUserUsingFormData:r}=await q(async()=>{const{signUpUserUsingFormData:l}=await import("./3hQXMHQA.js").then(async o=>(await o.__tla,o));return{signUpUserUsingFormData:l}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url);r(s,"learner",!0)}else J(a)},enableTurnstile:!0,turnstileSiteKey:c},V=async function(a){localStorage&&(b.set({}),localStorage.clear(),X()),sessionStorage&&sessionStorage.clear(),a&&H(await e("logout_message")),y("/")},O=function(a){const t=window.location.href,i=p(b).is_guest_mode,s=new URLSearchParams({client_id:Y,redirect_uri:`${window.location.origin}/auth/google`,response_type:"token",scope:"openid email profile",prompt:"select_account"}),r={defaultUrl:t,...i?{returnUrl:t,role:a}:{role:a}};s.append("state",encodeURIComponent(JSON.stringify(r))),window.location.href=`https://accounts.google.com/o/oauth2/v2/auth?${s}`},v=async(a,t,i,s=()=>{},r)=>{var m;const l=p(Q).instance_id,o=(m=p(C))!=null&&m.principal_enabled?r:"learner",u={action_type:o,email:a==null?void 0:a.email,login_type:i,token:t,role:o},n=await g(f.SOCIAL_LOGIN,u,{headers:{instance_id:l}});if(n.error_code==0&&n.data.length>0){b.set(n.data[0]);let _="/competitions";n.data[0].active_role==="principal"&&(_=n.data[0].profile_completion_step?"/admin/competitions":"/account/institution/details"),await y(_),typeof s=="function"&&s()}return n},R=async function(a){const t=new URLSearchParams(a.replace("#","?")),i=t.get("access_token"),s=p(b).is_guest_mode;let r=null,l=null,o=null;if(t.has("state")&&({returnUrl:r,defaultUrl:l,role:o}=JSON.parse(decodeURIComponent(t.get("state")||""))),i){const u=await g(f.GOOGLE_USER,{},{headers:{Authorization:`Bearer ${i}`}}),n=await v(u,i,3,void 0,o);r&&y(r),(n==null?void 0:n.error_code)!==0&&!s&&y(l)}},K=function(){p(w).visible&&w.set({visible:!1,page:""}),window.dispatchEvent(new Event("loaderStart")),j(B)};const z=async a=>{var n;const t=new URLSearchParams(window.location.search),i=p(C),s=t.get("change_code")||"",r=t.get("role")||"",l=t.get("index")||"",o={change_code:s,profile_picture:W().toString(),password:a==null?void 0:a.password,t_token:a==null?void 0:a.turnstileToken,role:i!=null&&i.principal_enabled?r:"learner",index:l},u=await g(f.EMAIL_SIGNUP_VERIFICATION,o,{});if(u.error_code==0){const{loginUser:m}=await q(async()=>{const{loginUser:_}=await import("./3hQXMHQA.js").then(async k=>(await k.__tla,k));return{loginUser:_}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url);await m((n=u==null?void 0:u.data)==null?void 0:n.email,a==null?void 0:a.password)}},J=async a=>{const t=p(d),{turnstileToken:i,...s}=a,r={...s,phone_number:t.phone_number,t_token:i,otp:a.otp};(await g(f.OTP_VERIFY,r,{})).error_code==0&&d.update(l=>({...l,is_otp_verified:!0}))}});export{Z as __tla,w as a,T as b,I as c,E as d,P as e,R as f,L as g,O as h,K as i,x as j,A as k,V as l,D as m,S as n,d as o,F as p,v as q,N as r,G as s,$ as u};
