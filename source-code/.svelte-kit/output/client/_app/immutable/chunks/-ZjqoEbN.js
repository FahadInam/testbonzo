const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./LAhWfPf4.js","./Bhxzz1gg.js","./D_1OQ_gr.js","./UMRfY9Ko.js","./DIeogL5L.js","./CS3uJLGD.js","./KMGk3Nas.js","./rUUE80t4.js","./CpOe2gu7.js","./zx05KRmR.js","./EefveEWF.js","./CN0MmCAJ.js","./BT9fSTVj.js","./Dt_aWHDm.js","./BuuPHrM8.js","./KgIHh09F.js","./DAxMji9q.js","./CUEp9C6H.js","./CaXA0QRm.js","./xsk9tW-i.js","./CVxajco_.js","../assets/toast.KOmfmGu7.css","./Bph8yTrC.js","./B_ot-s7H.js","./BtY6RuN-.js","./BhqQrrNl.js","./Buhwy7Lv.js"])))=>i.map(i=>d[i]);
import{_ as v}from"./CmsKOCeN.js";import{g as e}from"./KgIHh09F.js";import{b as j,P as p,r as _,c as z}from"./KMGk3Nas.js";import{w as h,g as w}from"./CS3uJLGD.js";import{g as b}from"./Bhxzz1gg.js";import{b as J}from"./CVxajco_.js";import{u as g}from"./rUUE80t4.js";import{A as y,__tla as Y}from"./xsk9tW-i.js";import{i as B}from"./CpOe2gu7.js";import"./EefveEWF.js";import"./BuuPHrM8.js";import"./DAxMji9q.js";import{a as H}from"./Bph8yTrC.js";import{r as M}from"./B_ot-s7H.js";let c,k,q,C,T,I,E,P,L,O,R,K,x,f,d,A,S,V,D,F,Q=Promise.all([(()=>{try{return Y}catch{}})()]).then(async()=>{c=h({page:"user-login",visible:!1}),f=h({isVisible:!1,url:""});function N(a){f.set({isVisible:!0,url:a})}A=function(){f.set({isVisible:!1,url:""})},d=h({is_otp_verified:!1,phone_number:null}),D={title:await e("get_started"),fields:[{name:"email",type:"email",label:await e("email"),placeholder:await e("enter_your_email"),required:!0},{name:"password",type:"password",label:await e("password"),placeholder:await e("enter_your_password"),required:!0}],buttons:[{label:await e("signup"),customClass:"w-full",type:"submit"}],enableTurnstile:!0,turnstileSiteKey:p},E={title:await e("get_started"),fields:[{name:"email",type:"email",label:await e("email"),placeholder:await e("enter_your_email"),required:!0}],buttons:[{label:await e("signup"),customClass:"w-full",type:"submit"}],enableTurnstile:!0,turnstileSiteKey:p},C={title:await e("welcome"),fields:[{name:"email",type:"email",label:await e("email"),placeholder:await e("enter_your_email"),required:!0},{name:"password",type:"password",label:await e("password"),placeholder:await e("enter_your_password"),required:!0}],buttons:[{label:await e("login"),type:"submit",customClass:"w-full"}],enableTurnstile:!1,turnstileSiteKey:"site-key"},F=[{image:"/images/learner-icon.svg",title:await e("a_learner"),description:await e("play_fun_games"),link:"/account/user/signup"},{image:"/images/institute-icon.svg",title:await e("an_institute"),description:await e("empower"),link:"/account/institution/signup"}],q=[{image:"/images/learner-icon.svg",title:await e("a_learner"),description:await e("play_fun_games"),onClick:()=>{c.set({visible:!0,page:"user-signup"})}},{image:"/images/institute-icon.svg",title:await e("an_institute"),description:await e("empower"),onClick:()=>{c.set({visible:!0,page:"institution-signup"})}}],x={title:await e("forgot_password"),fields:[{name:"email",type:"email",label:await e("email"),placeholder:await e("enter_your_email"),required:!0}],buttons:[{label:await e("send_reset_link"),type:"submit",customClass:"w-full"}],enableTurnstile:!0,turnstileSiteKey:p},V={title:await e("reset_password"),fields:[{name:"password",type:"password",label:await e("enter_new_password"),placeholder:await e("enter_your_new_password"),required:!0},{name:"confirmPassword",type:"password",label:await e("confirm_new_password"),placeholder:await e("re_enter_new_password"),required:!0}],buttons:[{label:await e("reset_password"),type:"submit",customClass:"w-full"}],enableTurnstile:!1,turnstileSiteKey:"site-key"},T={title:await e("get_started"),fields:[{name:"password",type:"password",label:await e("password"),placeholder:await e("password"),required:!0}],buttons:[{label:await e("signup"),type:"submit",customClass:"w-full"}],footer:{text:await e("already_account"),button:{label:await e("login"),type:"secondary-outlined-inverted",link:"/account/user/login"}},handleSubmit:async a=>{G(a)},enableTurnstile:!0,turnstileSiteKey:p},R={title:await e("welcome"),fields:[{name:"phone_number",type:"tel",label:await e("phone_number"),prefix:"+254",required:!0,placeholder:await e("enter_phone_number")},{name:"password",type:"password",label:await e("password"),placeholder:await e("enter_your_password"),required:!0}],buttons:[{label:await e("login"),type:"submit",customClass:"w-full"}],enableTurnstile:!1,turnstileSiteKey:"site-key"},O={title:await e("welcome"),fields:[{name:"phone_number",type:"tel",label:await e("phone_number"),prefix:"+254",required:!0,placeholder:await e("enter_phone_number")}],buttons:[{label:await e("signup"),type:"submit",customClass:"w-full"}],enableTurnstile:!0,turnstileSiteKey:p},k={title:await e("confirm_your_number"),fields:[{name:"otp",type:"text",label:await e("otp_code"),placeholder:await e("enter_code"),required:!0},{name:"password",type:"password",label:await e("password"),placeholder:await e("password"),required:!0,isShow:!1}],buttons:[{label:await e("verify"),type:"submit",customClass:"w-full"}],footer:{text:await e("already_account"),button:{label:await e("login"),type:"secondary-outlined-inverted",link:"/account/user/login"}},handleSubmit:async a=>{const{is_otp_verified:t,phone_number:i}=w(d);if(t){const s={...a,phone_number:i,username:""},{signUpUserUsingFormData:r}=await v(async()=>{const{signUpUserUsingFormData:n}=await import("./LAhWfPf4.js").then(async o=>(await o.__tla,o));return{signUpUserUsingFormData:n}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url);r(s,"learner",!0)}else $(a)},enableTurnstile:!0,turnstileSiteKey:p},K=async function(a){localStorage&&(g.set({}),localStorage.clear(),M()),sessionStorage&&sessionStorage.clear(),a&&J(await e("logout_message")),b("/")},P=function(a){const t=window.location.href,i=w(g).is_guest_mode,s=new URLSearchParams({client_id:j,redirect_uri:`${window.location.origin}/auth/google`,response_type:"token",scope:"openid email profile",prompt:"select_account"}),r={defaultUrl:t,...i?{returnUrl:t,role:a}:{role:a}};s.append("state",encodeURIComponent(JSON.stringify(r))),window.location.href=`https://accounts.google.com/o/oauth2/v2/auth?${s}`},S=async(a,t,i,s=()=>{},r)=>{const n=w(B).instance_id,o=r,u={action_type:o,email:a==null?void 0:a.email,login_type:i,token:t,role:o},l=await _(y.SOCIAL_LOGIN,u,{headers:{instance_id:n}});if(l.error_code==0&&l.data.length>0){g.set(l.data[0]);let m="/competitions";l.data[0].active_role==="principal"&&(m=l.data[0].profile_completion_step?"/admin/competitions":"/account/institution/details"),await b(m),typeof s=="function"&&s()}return l},I=async function(a){const t=new URLSearchParams(a.replace("#","?")),i=t.get("access_token"),s=w(g).is_guest_mode;let r=null,n=null,o=null;if(t.has("state")&&({returnUrl:r,defaultUrl:n,role:o}=JSON.parse(decodeURIComponent(t.get("state")||""))),i){const u=await _(y.GOOGLE_USER,{},{headers:{Authorization:`Bearer ${i}`}}),l=await S(u,i,3,void 0,o);r&&b(r),(l==null?void 0:l.error_code)!==0&&!s&&b(n)}},L=function(){w(c).visible&&c.set({visible:!1,page:""}),window.dispatchEvent(new Event("loaderStart")),N(z)};const G=async a=>{var u;const t=new URLSearchParams(window.location.search),i=t.get("change_code")||"",s=t.get("role")||"",r=t.get("index")||"",n={change_code:i,profile_picture:H().toString(),password:a==null?void 0:a.password,t_token:a==null?void 0:a.turnstileToken,role:s,index:r},o=await _(y.EMAIL_SIGNUP_VERIFICATION,n,{});if(o.error_code==0){const{loginUser:l}=await v(async()=>{const{loginUser:m}=await import("./LAhWfPf4.js").then(async U=>(await U.__tla,U));return{loginUser:m}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url);await l((u=o==null?void 0:o.data)==null?void 0:u.email,a==null?void 0:a.password)}},$=async a=>{const t=w(d),{turnstileToken:i,...s}=a,r={...s,phone_number:t.phone_number,t_token:i,otp:a.otp};(await _(y.OTP_VERIFY,r,{})).error_code==0&&d.update(n=>({...n,is_otp_verified:!0}))}});export{Q as __tla,c as a,k as b,q as c,C as d,T as e,I as f,E as g,P as h,L as i,O as j,R as k,K as l,x as m,f as n,d as o,A as p,S as q,V as r,D as s,F as u};
