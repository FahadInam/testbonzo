import{ae as c,x,ab as z,C as A}from"./BWmI7Kwv.js";function y(n,r,s){if(n==null)return r(void 0),s&&s(void 0),c;const e=x(()=>n.subscribe(r,s));return e.unsubscribe?()=>e.unsubscribe():e}const a=[];function B(n,r){return{subscribe:g(n,r).subscribe}}function g(n,r=c){let s=null;const e=new Set;function i(o){if(z(n,o)&&(n=o,s)){const u=!a.length;for(const t of e)t[1](),a.push(t,n);if(u){for(let t=0;t<a.length;t+=2)a[t][0](a[t+1]);a.length=0}}}function l(o){i(o(n))}function b(o,u=c){const t=[o,u];return e.add(t),e.size===1&&(s=r(i,l)||c),o(n),()=>{e.delete(t),e.size===0&&s&&(s(),s=null)}}return{set:i,update:l,subscribe:b}}function C(n,r,s){const e=!Array.isArray(n),i=e?[n]:n;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const l=r.length<2;return B(s,(b,o)=>{let u=!1;const t=[];let d=0,p=c;const v=()=>{if(d)return;p();const f=r(e?t[0]:t,b,o);l?b(f):p=typeof f=="function"?f:c},m=i.map((f,h)=>y(f,w=>{t[h]=w,d&=~(1<<h),u&&v()},()=>{d|=1<<h}));return u=!0,v(),function(){A(m),p(),u=!1}})}function q(n){let r;return y(n,s=>r=s)(),r}export{C as d,q as g,y as s,g as w};
