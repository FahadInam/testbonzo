import{g as o}from"./Bhxzz1gg.js";import{r as p}from"./KMGk3Nas.js";import{r as O,u as m,i as F}from"./CpOe2gu7.js";import{g as i}from"./CS3uJLGD.js";import{A as c,__tla as M}from"./xsk9tW-i.js";import{i as x,h as C,g as j,j as z,s as H,k as K,d as q,l as b,o as D,a as _,r as V,m as $,__tla as J}from"./-ZjqoEbN.js";import{g as e}from"./KgIHh09F.js";import{a as Q}from"./CVxajco_.js";import{u as g}from"./rUUE80t4.js";import{p as I}from"./Dt_aWHDm.js";import{a as l,i as h,b as W}from"./DAxMji9q.js";import{g as X,a as Y}from"./Bph8yTrC.js";import{g as u}from"./B_ot-s7H.js";import{c as v}from"./zx05KRmR.js";import{s as Z,__tla as aa}from"./BtY6RuN-.js";let N,f,G,L,A,k,U,R,S,T,ea=Promise.all([(()=>{try{return M}catch{}})(),(()=>{try{return J}catch{}})(),(()=>{try{return aa}catch{}})()]).then(async()=>{let P;U={...l?K:q,handleSubmit:async a=>{await f(a.email,a.password,a.phone_number)},...l?{}:{alternativeButtons:[{label:await e("c_coach"),type:"secondary-outlined-inverted",image:"/images/coach-icon.png",onClick:()=>x()},{label:await e("c_google"),type:"secondary-outlined-inverted",image:"/images/google-icon.png",onClick:a=>C(a)}]},footer:{text:await e("no_account"),button:{label:await e("signup"),type:"secondary-outlined-inverted",link:"/account/user/signup"}},forgotPassword:{label:await e("forgot_password"),link:"/account/forgot-password"},role:"login"},P=()=>h?j:l?z:H,S={...P(),handleSubmit:async a=>{await k(a)},...l?{}:{alternativeButtons:[{label:await e("c_coach"),type:"secondary-outlined-inverted",image:"/images/coach-icon.png",onClick:()=>x()},{label:await e("c_google"),type:"secondary-outlined-inverted",image:"/images/google-icon.png",onClick:a=>C(a)}]},footer:{text:await e("already_account"),button:{label:await e("login"),type:"secondary-outlined-inverted",link:"/account/user/login"}},role:"learner"},T={...S,footer:{text:await e("already_account"),button:{label:await e("login"),type:"secondary-outlined-inverted",onClick:()=>{_.set({visible:!0,page:"user-login"})}}}},R={...U,footer:{text:await e("no_account"),button:{label:await e("signup"),type:"secondary-outlined-inverted",onClick:()=>{_.set({visible:!0,page:"user-selection"})}}}},N={...$,footer:{text:await e("back_to_login"),button:{label:await e("login"),type:"secondary-outlined-inverted",link:"/account/user/login"}},role:"learner"},A={...V,footer:{text:await e("back_to_login"),button:{label:await e("login"),type:"secondary-outlined-inverted",link:"/account/user/login"}},role:"learner"},k=async function(a,n="learner",r=!1){const s=O({...a,name:"",profile_picture:(W?X().id:Y()).toString(),role:n,...l&&!r&&{otp_type:1}},{email:h?"email":"username",turnstileToken:"t_token"}),d=i(F).instance_id,y=h?c.EMAIL_SIGNUP:l&&!r?c.OTP_SIGNUP:c.SIGNUP_USER,w=s.username||s.phone_number,t=s.password,E=await p(y,s,{headers:{instance_id:d}});E.error_code==0&&(l&&!r?(o("/account/verify-code"),D.update(B=>({...B,phone_number:a.phone_number}))):E.data.origin?o("/account/verify",{state:{data:s}}):await f(w,t))},f=async function(a,n,r){const s=i(F).instance_id,d=i(u).points,y=i(v).url,w=i(u).guest_mode,t=await p(c.LOGIN_USER,{username:a||r,password:n},{headers:{instance_id:s}});t.error_code==0&&t.data.length>0&&(g.set(t.data[0]),m(g,"is_guest_mode",!1),i(_).visible?(_.set({visible:!1,page:""}),d>0&&t.data[0].active_role!="principal"&&await Z({competition_id:i(v).competition_id,grade:i(v).current_grade,points:d}),w?t.data[0].active_role=="principal"?(t.data[0].profile_completion_step?o("/admin/competitions"):o("/account/institution/details"),m(u,"guest_mode",!1)):(o(`/competitions/${y}/home`),m(u,"guest_mode",!1)):(m(u,"guest_mode",!1),o(I.url.pathname)),console.log(I,"pagepage")):t.data[0].active_role=="principal"?t.data[0].profile_completion_step?o("/admin/competitions"):o("/account/institution/details"):o("/competitions"))},G=async function(a){{let n=null;const r=i(g).refresh_token;if(!r)return b(!0);try{n=await p(c.TOKEN_REFRESH,{},{headers:{Authorization:"Bearer "+r},allowFailing:!0})}catch{return b(!0)}n&&n.error_code==0?(g.set(n.data[0]),a()):b(!0)}},L=async function(a){(await p(c.EMAIL_SIGNUP,a)).error_code==0&&Q("Email sent successfully!")}});export{ea as __tla,N as forgotPasswordForm,f as loginUser,G as refreshUserToken,L as resendEmail,A as resetPasswordForm,k as signUpUserUsingFormData,U as userLoginForm,R as userLoginFormPopup,S as userSignUpForm,T as userSignUpFormPopup};
