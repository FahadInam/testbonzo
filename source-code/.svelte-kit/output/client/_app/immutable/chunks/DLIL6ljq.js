import{g as c}from"./CS3uJLGD.js";import{c as _}from"./zx05KRmR.js";import{r as l}from"./KMGk3Nas.js";import{A as m,__tla as R}from"./xsk9tW-i.js";import{b as N,f as A}from"./CpOe2gu7.js";import{P as S,a as w,i as y,__tla as h}from"./BtY6RuN-.js";import{g as k}from"./Bhxzz1gg.js";let o,p,d,g,f,C=Promise.all([(()=>{try{return R}catch{}})(),(()=>{try{return h}catch{}})()]).then(async()=>{o={RESULT:2,INVITATION:1,REWARD:6,REWARD_SCREEN:3,NOTIFICATION:4,CERTIFICATE:5},g=async function(){var i;await N();const{competition_id:n,current_grade:t}=c(_),e=await l(m.GET_USER_NOTIFICATIONS,{competition_id:n,grade:t});return e.error_code===0&&((i=e.data)!=null&&i.rows)?u(e.data.rows):[]};function u(n){return!n||!Array.isArray(n)?[]:n.map(t=>{try{t.message_inapp&&t.json_data?t.formattedMessage=A(t.message_inapp,t.json_data):t.formattedMessage=t.message_inapp||"Unknown message"}catch{t.formattedMessage=t.message_inapp||"Unknown message"}return t})}f=async function(){const{competition_id:n}=c(_);await l(m.UPDATE_USER_NOTIFICATIONS,{competition_id:n})},p=function(n){if(!n)return"";const t=new Date(n),e=t.getDate(),i=t.toLocaleString("default",{month:"short"}),r=t.getFullYear();let a=t.getHours();const s=String(t.getMinutes()).padStart(2,"0"),T=a>=12?"pm":"am";a=a%12,a=a||12;const E=String(a).padStart(2,"0");return`${e} ${i}, ${r} (${E}:${s} ${T})`},d=function(n){const{event_item:t}=n;switch(t){case o.RESULT:console.log("Handling Result notification");break;case o.INVITATION:I(n);break;case o.REWARD:console.log("Handling Reward notification");break;case o.REWARD_SCREEN:console.log("Handling Reward Screen notification");break;case o.NOTIFICATION:console.log("Handling General Notification");break;case o.CERTIFICATE:console.log("Handling Certificate notification");break;default:console.log("Unknown notification type")}};async function I(n){console.log(n,"data212");const{json_data:t,notifications_users_id:e,profile_picture:i,send:r}=n,a=JSON.parse(t);console.log(a,"parsedJson");const s=await S(a);s.error_code===0&&(w({opponent:{profile_picture:a.opponent_profile_picture,name:a.opponent_name,user_id:a.opponent_id},playMode:1,matchData:s.data,subjectData:{summary_id:a==null?void 0:a.summary_id,match_id:a==null?void 0:a.match_id,content_id:a==null?void 0:a.content_id},link:a.link}),await y(a),k("/challenge/vsscreen"))}});export{o as N,C as __tla,p as f,d as h,g as l,f as u};
