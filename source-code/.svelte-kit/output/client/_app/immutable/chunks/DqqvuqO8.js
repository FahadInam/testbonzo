import{f as p,c as _}from"./DWJ43-ZD.js";import{w as W,g as i}from"./C_S5TygX.js";import{g as q}from"./Bz4n4I_X.js";import{A as r,__tla as Y}from"./Djyhf4cp.js";import{r as d}from"./CR2liGHp.js";import{u as $}from"./Bvbqq-zN.js";import{g as D}from"./BoEBYeq-.js";import{a as z}from"./ClXJh1T-.js";import{u as I}from"./Q_rB2KR5.js";import{m as w}from"./CuKIkSf6.js";let C,G,P,H,A,L,u,k,O,R,v,V,x,M,B=Promise.all([(()=>{try{return Y}catch{}})()]).then(async()=>{let g;g={player:{name:"Player",avatar:null,score:"0",points:0,accuracy:"0%",timeTaken:"0s"},opponent:{name:"Opponent",avatar:null,score:"0",accuracy:"-",timeTaken:"-"},gameStatus:{isWinner:!1,isCompleted:!1,statusText:"Ongoing"}},u=W(g),V=function(){u.set(g)},A=function(t){u.update(a=>({...a,player:{...a.player,...t}}))},L=function(t){u.update(a=>({...a,opponent:{...a.opponent,...t}}))},R=async function(){await p();const t=i(_).current_grade,a=i(_).competition_id,e=i(q).subject;return await d(r.CHALLENGE_FRIENDS,{competition_id:a,grade:t,subject:e},{})},H=async function(t,a,e){await p();const o=i(_).current_grade,n=i(_).competition_id,{subject:c,content_id:s,type:m}=t;return console.log({competition_id:n,grade:o,subject:c,content_id:s,friend_id:a.user_id||a.id,is_game:1,content_type:m}),await d(r.CHALLENGE_START,{competition_id:n,grade:o,subject:c,content_id:s,...e===1?{friend_id:a.user_id||a.id}:{},is_game:1,content_type:m},{})},G=async function(t){await p();const a=i(_).current_grade,e=i(_).competition_id,{subject:o,match_id:n}=t;return await d(r.CHALLENGE_PLAY,{competition_id:e,grade:a,match_id:n,subject:o},{})},P=async function(t,a){console.log(t,a,"subjectData");const e=await p(),o=i(w).id,n=i(w).url,{summary_id:c,content_id:s,match_id:m}=t,{question_data:f,total_questions:h,total_correct:E,total_attempted:b,total_time_spent:l}=a,T=await d(r.CHALLENGE_SAVE,{competition_id:o,grade:e,match_id:m,summary_id:c,is_resigned:1,content_id:s,total_questions:h,total_correct:E,total_attempted:b,total_time_spent:l,question_data:{data:f}},{});T.error_code===0&&(u.update(N=>{var j;return{...N,player:{...N.player,score:(j=T.data)==null?void 0:j.my_score}}}),console.log("url",n),D(`/competitions/${n}`),z("You have resigned the match"))},k=async function(t,a){await p();const e=await p(),o=i(w).id,{summary_id:n,content_id:c,match_id:s}=t,{question_data:m,total_questions:f,total_correct:h,total_attempted:E,total_time_spent:b}=a,l=await d(r.CHALLENGE_SAVE,{competition_id:o,grade:e,match_id:s,summary_id:n,is_resigned:0,content_id:c,total_questions:f,total_correct:h,total_attempted:E,total_time_spent:b,question_data:{data:m}},{});l.error_code===0&&S(l.data)};let S,y;S=t=>{var o;const a=(o=i(I))==null?void 0:o.total_coins_earned,e=a+Number(t==null?void 0:t.points_earned);console.log(t,a,e,"responseData"),A({score:t==null?void 0:t.my_score,points:t==null?void 0:t.points_earned}),L({score:t==null?void 0:t.opponent_score,accuracy:y(t==null?void 0:t.opponent_total_correct,t==null?void 0:t.opponent_total_questions,t==null?void 0:t.opponent_total_questions),timeTaken:t==null?void 0:t.opponent_time_spent}),console.log(e,a,t==null?void 0:t.points_earned,"points_earned"),I.set({total_coins_earned:e}),D("/challenge/result")},C=t=>{var a;return((a=i($))==null?void 0:a.user_id)===t||t<1},y=(t,a,e)=>{let o=a;return a<5&&a<e&&(o=5),t/o},O=(t,a,e,o)=>y(t,a,e)*o,M=function({opponent:t,playMode:a,matchData:e,subjectData:o,matchingItem:n={},link:c}){console.log(n,"matchingItem"),q.update(s=>({...s,...n,...a===1&&{opponent:t},isSinglePlayer:a,matchData:e,subjectData:{summary_id:e==null?void 0:e.summary_id,match_id:e==null?void 0:e.match_id,content_id:(o==null?void 0:o.content_id)||(s==null?void 0:s.content_id),base_points:o==null?void 0:o.base_points},link:c}))},v=async function(t,a){const{row_id:e,match_id:o}=t,n=i(_).competition_id;await d(r.CHALLENGE_INVITATION_STATUS,{competition_id:n,row_id:e,match_id:o,status:a})},x=async function(t){const{competition_id:a,grade:e,points:o}=t,n=o>200?200:o;await d(r.SET_GRADE_POINTS,{competition_id:a,grade:e,points:n})}});export{C as I,G as P,P as R,H as S,B as __tla,A as a,L as b,u as c,k as d,O as e,R as g,v as i,V as r,x as s,M as u};
